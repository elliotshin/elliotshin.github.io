# Blog Post 1
In this blog post, we will be exploring the use of SQL to manage databases and how we can make some really cool visualizations using plotly!


```python

import pandas as pd
import seaborn as sns 
import numpy as mp
import sqlite3
```

## Creating a Database
We want to first download our dataframes, make sure they are saved in the same directory as your current working directory


```python

temperatures = pd.read_csv("temps.csv")
countries = pd.read_csv("countries.csv")
stations = pd.read_csv("station-metadata.csv")
```

Let's take a look at our data! 


```python
temperatures.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Year</th>
      <th>VALUE1</th>
      <th>VALUE2</th>
      <th>VALUE3</th>
      <th>VALUE4</th>
      <th>VALUE5</th>
      <th>VALUE6</th>
      <th>VALUE7</th>
      <th>VALUE8</th>
      <th>VALUE9</th>
      <th>VALUE10</th>
      <th>VALUE11</th>
      <th>VALUE12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACW00011604</td>
      <td>1961</td>
      <td>-89.0</td>
      <td>236.0</td>
      <td>472.0</td>
      <td>773.0</td>
      <td>1128.0</td>
      <td>1599.0</td>
      <td>1570.0</td>
      <td>1481.0</td>
      <td>1413.0</td>
      <td>1174.0</td>
      <td>510.0</td>
      <td>-39.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACW00011604</td>
      <td>1962</td>
      <td>113.0</td>
      <td>85.0</td>
      <td>-154.0</td>
      <td>635.0</td>
      <td>908.0</td>
      <td>1381.0</td>
      <td>1510.0</td>
      <td>1393.0</td>
      <td>1163.0</td>
      <td>994.0</td>
      <td>323.0</td>
      <td>-126.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACW00011604</td>
      <td>1963</td>
      <td>-713.0</td>
      <td>-553.0</td>
      <td>-99.0</td>
      <td>541.0</td>
      <td>1224.0</td>
      <td>1627.0</td>
      <td>1620.0</td>
      <td>1596.0</td>
      <td>1332.0</td>
      <td>940.0</td>
      <td>566.0</td>
      <td>-108.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACW00011604</td>
      <td>1964</td>
      <td>62.0</td>
      <td>-85.0</td>
      <td>55.0</td>
      <td>738.0</td>
      <td>1219.0</td>
      <td>1442.0</td>
      <td>1506.0</td>
      <td>1557.0</td>
      <td>1221.0</td>
      <td>788.0</td>
      <td>546.0</td>
      <td>112.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACW00011604</td>
      <td>1965</td>
      <td>44.0</td>
      <td>-105.0</td>
      <td>38.0</td>
      <td>590.0</td>
      <td>987.0</td>
      <td>1500.0</td>
      <td>1487.0</td>
      <td>1477.0</td>
      <td>1377.0</td>
      <td>974.0</td>
      <td>31.0</td>
      <td>-178.0</td>
    </tr>
  </tbody>
</table>
</div>



In this cell we are going to add an extra column, called "FIPS" because it will help us combine our data later on


```python
stations["FIPS"] = stations["ID"].str[0:2]
stations.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>STNELEV</th>
      <th>NAME</th>
      <th>FIPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACW00011604</td>
      <td>57.7667</td>
      <td>11.8667</td>
      <td>18.0</td>
      <td>SAVE</td>
      <td>AC</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AE000041196</td>
      <td>25.3330</td>
      <td>55.5170</td>
      <td>34.0</td>
      <td>SHARJAH_INTER_AIRP</td>
      <td>AE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AEM00041184</td>
      <td>25.6170</td>
      <td>55.9330</td>
      <td>31.0</td>
      <td>RAS_AL_KHAIMAH_INTE</td>
      <td>AE</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AEM00041194</td>
      <td>25.2550</td>
      <td>55.3640</td>
      <td>10.4</td>
      <td>DUBAI_INTL</td>
      <td>AE</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AEM00041216</td>
      <td>24.4300</td>
      <td>54.4700</td>
      <td>3.0</td>
      <td>ABU_DHABI_BATEEN_AIR</td>
      <td>AE</td>
    </tr>
  </tbody>
</table>
</div>



In this cell we are going to RENAME our "FIPS 10-4" column to "FIPS"! Hmmmm, seems like there is a connection already to the previous dataframe.


```python
countries["FIPS"] = countries["FIPS 10-4"]
countries.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FIPS 10-4</th>
      <th>ISO 3166</th>
      <th>Name</th>
      <th>FIPS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AF</td>
      <td>AF</td>
      <td>Afghanistan</td>
      <td>AF</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AX</td>
      <td>-</td>
      <td>Akrotiri</td>
      <td>AX</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>AL</td>
      <td>Albania</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AG</td>
      <td>DZ</td>
      <td>Algeria</td>
      <td>AG</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AQ</td>
      <td>AS</td>
      <td>American Samoa</td>
      <td>AQ</td>
    </tr>
  </tbody>
</table>
</div>



The following cell will open up our database! Let's name it "temps.db". If you check your directory, you'll see that this file is now visible.


```python
conn = sqlite3.connect("temps.db")
```

The following function will be used to prepare our data


```python

def prepare_df(df):
    """makes data really nice, converts temp to degree celsius, prepares FIPS column""" 
    df = df.set_index(keys=["ID", "Year"])
    df = df.stack()
    df = df.reset_index()
    df = df.rename(columns = {"level_2"  : "Month" , 0 : "Temp"})
    df["Month"] = df["Month"].str[5:].astype(int)
    df["Temp"]  = df["Temp"] / 100
    df["FIPS"] = df["ID"].str[0:2]
    return(df)
```

We will now perform our prepare_df function on our temps.csv data, unfortunately, the csv file is too big, so we will have to do something called **chunking**. This is a process that creates an iterator that allows the data from our csv to be entered into our database in bite-sized, digestable pieces.
So, we create an iterator and iterate through our data, preparing each chunk at a time, and then reading it into our database.


```python
df_iter = pd.read_csv("temps.csv", chunksize = 100000)
for df in df_iter:
    df = prepare_df(df)
    df.to_sql("temperatures", conn, if_exists = "append",index = False)
```

Now we are going to read in the two other csv files, due to their smaller size, we do not need to chunk.


```python
stations.to_sql("stations",conn,if_exists = "replace", index = False)
```


```python
countries.to_sql("countries", conn, if_exists = "replace",index = False)
```

    C:\Users\ellio\anaconda3\lib\site-packages\pandas\core\generic.py:2779: UserWarning: The spaces in these column names will not be changed. In pandas versions < 0.14, spaces were converted to underscores.
      sql.to_sql(
    
## Writing a Query Function
This code opens up an explorer object called a cursor that allows us to select specific data from our database! Let's test it out by selecting just our different DATAFRAME titles within our newly created DATABASE. 


```python
cursor = conn.cursor() #explorer object
cursor.execute("SELECT name FROM sqlite_master WHERE type='table'") #"hey please look at the sqlite_master object and give me the names of objects with type table"
print(cursor.fetchall()) #the two tables are temperatures and stations 
```

    [('temperatures',), ('stations',), ('countries',)]
    


```python
cursor.execute("SELECT sql FROM sqlite_master WHERE type='table';")

for result in cursor.fetchall():
    print(result[0])
```

    CREATE TABLE "temperatures" (
    "ID" TEXT,
      "Year" INTEGER,
      "Month" INTEGER,
      "Temp" REAL,
      "FIPS" TEXT
    )
    CREATE TABLE "stations" (
    "ID" TEXT,
      "LATITUDE" REAL,
      "LONGITUDE" REAL,
      "STNELEV" REAL,
      "NAME" TEXT,
      "FIPS" TEXT
    )
    CREATE TABLE "countries" (
    "FIPS 10-4" TEXT,
      "ISO 3166" TEXT,
      "Name" TEXT,
      "FIPS" TEXT
    )
    

GREAT! Now let's apply that same technique but get more specific, let's see if we can get data about the temperature in India for the years 1980 to 2020 


```python
cmd = \
"""
SELECT S.name, S.latitude, S.longitude, C.name, T.year, T.month, T.temp
FROM stations S
LEFT JOIN temperatures T on S.id = T.id
LEFT JOIN countries C on T.fips = C.fips
WHERE T.month = 1 AND T.year >= 1980 AND T.year <= 2020 AND C.name = 'India'
"""

test = pd.read_sql_query(cmd,conn) #use this command to read queries in
test
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>Name</th>
      <th>Year</th>
      <th>Month</th>
      <th>Temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1980</td>
      <td>1</td>
      <td>23.48</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1981</td>
      <td>1</td>
      <td>24.57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1982</td>
      <td>1</td>
      <td>24.19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>23.51</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1984</td>
      <td>1</td>
      <td>24.81</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3147</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>5.10</td>
    </tr>
    <tr>
      <th>3148</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1986</td>
      <td>1</td>
      <td>6.90</td>
    </tr>
    <tr>
      <th>3149</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1994</td>
      <td>1</td>
      <td>8.10</td>
    </tr>
    <tr>
      <th>3150</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1995</td>
      <td>1</td>
      <td>5.60</td>
    </tr>
    <tr>
      <th>3151</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1997</td>
      <td>1</td>
      <td>5.70</td>
    </tr>
  </tbody>
</table>
<p>3152 rows × 7 columns</p>
</div>



the following function is a more variable version of what we did above, allowing for user input into what data about what country they want to see.


```python
def query_climate_database(country, year_begin, year_end,month):
    """this function returns a dataframe from the database based on country, year_begin,year_end, and month"""
    country = country.replace("\"" ,'')
    com_str = ("SELECT S.name, S.latitude, S.longitude, C.name, T.year, T.month, T.temp "
              + "FROM stations S " + "LEFT JOIN temperatures T on S.id = T.id " + "LEFT JOIN countries C on T.fips = C.fips "
              + "WHERE T.month = " + str(month) + " AND T.year >= " + str(year_begin) +
                " AND T.year <= " + str(year_end) + " AND C.name = '" + country + "'" )
    cmd =  com_str
    selected_data = pd.read_sql_query(cmd,conn)
    return selected_data
```


```python
query_climate_database("India", 1980, 2020, 1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>Name</th>
      <th>Year</th>
      <th>Month</th>
      <th>Temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1980</td>
      <td>1</td>
      <td>23.48</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1981</td>
      <td>1</td>
      <td>24.57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1982</td>
      <td>1</td>
      <td>24.19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>23.51</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1984</td>
      <td>1</td>
      <td>24.81</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3147</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>5.10</td>
    </tr>
    <tr>
      <th>3148</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1986</td>
      <td>1</td>
      <td>6.90</td>
    </tr>
    <tr>
      <th>3149</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1994</td>
      <td>1</td>
      <td>8.10</td>
    </tr>
    <tr>
      <th>3150</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1995</td>
      <td>1</td>
      <td>5.60</td>
    </tr>
    <tr>
      <th>3151</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1997</td>
      <td>1</td>
      <td>5.70</td>
    </tr>
  </tbody>
</table>
<p>3152 rows × 7 columns</p>
</div>



# Q3: Writing a Geographic Scatter Function for Yearly Temperature Increase

Now we are ready to start plotting. But first, let's create a linear regression function that can predict temperature increase over a date range! This will be helpful later when we plot!


```python
from plotly import express as px
from sklearn.linear_model import LinearRegression
color_map = px.colors.diverging.RdGy_r


def coef(df):
    """This function creates a linear regression model that predicts temperature change based on year"""
    x = df[["Year"]] 
    y = df["Temp"]   
    LR = LinearRegression()
    LR.fit(x, y)
    return LR.coef_[0]

```


```python
##Test cell to see if the functions work
test_pd = query_climate_database("India", 1980, 2020, 1)

coefs = test_pd.groupby(["NAME", "Month","LATITUDE","LONGITUDE"]).apply(coef)
coefs = coefs.reset_index()
degree_sign = u"\N{DEGREE SIGN}"
coefs["Estimated Yearly Increase(" + degree_sign +"C)"] = coefs[0]
coefs = coefs.drop([0], axis = 1)

```


```python
coefs
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>Month</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>Estimated Yearly Increase(°C)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AGARTALA</td>
      <td>1</td>
      <td>23.8830</td>
      <td>91.2500</td>
      <td>-0.006184</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AGRA</td>
      <td>1</td>
      <td>27.1667</td>
      <td>78.0333</td>
      <td>-0.095413</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AHMADABAD</td>
      <td>1</td>
      <td>23.0670</td>
      <td>72.6330</td>
      <td>0.006731</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AKOLA</td>
      <td>1</td>
      <td>20.7000</td>
      <td>77.0330</td>
      <td>-0.001776</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AKOLA</td>
      <td>1</td>
      <td>20.7000</td>
      <td>77.0670</td>
      <td>-0.005939</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>101</th>
      <td>TRIVANDRUM</td>
      <td>1</td>
      <td>8.5000</td>
      <td>77.0000</td>
      <td>0.022892</td>
    </tr>
    <tr>
      <th>102</th>
      <td>UDAIPUR_DABOK</td>
      <td>1</td>
      <td>24.6170</td>
      <td>73.8830</td>
      <td>0.072424</td>
    </tr>
    <tr>
      <th>103</th>
      <td>VARANASI_BABATPUR</td>
      <td>1</td>
      <td>25.4500</td>
      <td>82.8670</td>
      <td>-0.012996</td>
    </tr>
    <tr>
      <th>104</th>
      <td>VERAVAL</td>
      <td>1</td>
      <td>20.9000</td>
      <td>70.3670</td>
      <td>0.024848</td>
    </tr>
    <tr>
      <th>105</th>
      <td>VISHAKHAPATNAM</td>
      <td>1</td>
      <td>17.7170</td>
      <td>83.2330</td>
      <td>-0.034050</td>
    </tr>
  </tbody>
</table>
<p>106 rows × 5 columns</p>
</div>



Great! Now let's put everything together. 


```python
color_map = px.colors.diverging.RdGy_r
def temperature_coefficient_plot(country, year_begin, year_end, month,
                              min_obs, **kwargs):
    """This function selects data from a country in a specific date range, filters out 
    data from stations without min_obs, and takes in additional keyword arguments for a scatter_mapbox
    """
    #create a dictionary to translate month number to month name
    month_digits = {1: "January",
                   2:"February",
                   3:"March",
                   4:"April",
                    5:"May",
                    6:"June",
                    7:"July",
                    8:"August",
                    9:"September",
                    10:"October",
                    11:"November",
                    12:"December"
                   }
    map_title = ("Estimates of yearly increase in temperature in " 
             + month_digits[month] + " for stations in " + country + ", years " 
             + str(year_begin) +"-" + str(year_end)
            )
    country_pd = query_climate_database(country,year_begin,year_end,month)
    
    #filter out minimum obs
    country_pd= country_pd[country_pd.groupby("NAME")["NAME"].transform('count') > min_obs]
    
    #get temperature estimates
    country_coefs = country_pd.groupby(["NAME", "Month","LATITUDE","LONGITUDE"]).apply(coef)
    country_coefs = country_coefs.reset_index()
    degree_sign = u"\N{DEGREE SIGN}"
    country_coefs["Estimated Yearly Increase(" + degree_sign +"C)"] = country_coefs[0].round(4)
    country_coefs = country_coefs.drop([0], axis = 1)
    
    #create figure
    fig = px.scatter_mapbox(country_coefs, lat = "LATITUDE", lon = "LONGITUDE",
                    hover_name = "NAME",
                       color = "Estimated Yearly Increase(" + degree_sign +"C)", range_color = [-.1,.1], title = map_title,**kwargs)
    return fig
```


```python
fig = temperature_coefficient_plot("India",1980,2020,1,min_obs = 10,
                                   mapbox_style = "carto-positron",zoom = 2,
                                  color_continuous_scale=color_map)
```


```python
fig.update_layout(margin={"r":0,"t":30,"l":0,"b":0})
fig.show()
```


<div>                            <div id="69ca08da-1a4a-4fc9-87d0-7e85f79a646a" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("69ca08da-1a4a-4fc9-87d0-7e85f79a646a")) {                    Plotly.newPlot(                        "69ca08da-1a4a-4fc9-87d0-7e85f79a646a",                        [{"hovertemplate":"<b>%{hovertext}</b><br><br>LATITUDE=%{lat}<br>LONGITUDE=%{lon}<br>Estimated Yearly Increase(\u00b0C)=%{marker.color}<extra></extra>","hovertext":["AGARTALA","AHMADABAD","AKOLA","AKOLA","ALLAHABAD","ALLAHABAD_BAMHRAULI","AMRITSAR","AURANGABAD_CHIKALTH","BALASORE","BANGALORE","BAREILLY","BEGUMPETOBSY","BELGAUM_SAMBRA","BHOPAL_BAIRAGARH","BHUBANESWAR","BHUJ_RUDRAMATA","BIKANER","BOMBAY_COLABA","BOMBAY_SANTACRUZ","CALCUTTA_ALIPORE","CALCUTTA_DUM_DUM","CHERRAPUNJI","CHITRADURGA","COIMBATORE_PEELAMED","CUDDALORE","DALTONGANJ","DEHRADUN","DIBRUGARH_MOHANBAR","DUMKA","DWARKA","GADAG","GANGANAGAR","GAUHATI","GAYA","GOA_PANJIM","GORAKHPUR","GUNA","GWALIOR","HISSAR","HONAVAR","IMPHAL","INDORE","JABALPUR","JAGDALPUR","JAIPUR_SANGANER","JAISALMER","JHARSUGUDA","JODHPUR","KAKINADA","KARAIKAL","KODAIKANAL","KOTA_AERODROME","KOZHIKODE","KURNOOL","LUCKNOW_AMAUSI","MACHILIPATNAM","MADRAS_MINAMBAKKAM","MANGALORE_BAJPE","MINICOY","MINICOYOBSY","MO_AMINI","MO_RANCHI","MUKTESWAR_KUMAON","NAGPUR_SONEGAON","NELLORE","NEW_DELHI_PALAM","NEW_DELHI_SAFDARJUN","NORTH_LAKHIMPUR","PAMBAN","PATIALA","PATNA","PBO_ANANTAPUR","PENDRA_ROAD","POONA","PORT_BLAIR","RAIPUR","RAJKOT","RAMGUNDAM","RATNAGIRI","SAGAR","SANDHEADS","SATNA","SHILONG","SHIMLA","SHOLAPUR","SILCHAR","SRINAGAR","SURAT","TEZPUR","THIRUVANANTHAPURAM","THIRUVANANTHAPURAM","TIRUCHCHIRAPALLI","TRIVANDRUM","VARANASI_BABATPUR","VERAVAL","VISHAKHAPATNAM"],"lat":[23.883,23.067,20.7,20.7,25.441,25.5,31.71,19.85,21.517,12.967,28.367,17.45,15.85,23.283,20.25,23.25,28.0,18.9,19.117,22.533,22.65,25.25,14.233,11.033,11.767,24.05,30.317,27.483,24.267,22.3667,15.417,29.917,26.1,24.75,15.483,26.75,24.65,26.233,29.167,14.283,24.667,22.717,23.2,19.083,26.817,26.9,21.917,26.3,16.95,10.917,10.2333,25.15,11.25,15.8,26.75,16.2,13.0,12.917,8.3,8.3,11.117,23.317,29.4667,21.1,14.45,28.567,28.583,27.233,9.267,30.333,25.6,14.583,22.767,18.533,11.667,21.217,22.3,18.767,16.983,23.85,20.85,24.567,25.6,31.1,17.667,24.82,34.083,21.2,26.617,8.467,8.483,10.767,8.5,25.45,20.9,17.717],"legendgroup":"","lon":[91.25,72.633,77.033,77.067,81.735,81.9,74.797,75.4,86.933,77.583,79.4,78.47,74.617,77.35,85.833,69.667,73.3,72.8167,72.85,88.333,88.45,91.7333,76.433,77.05,79.767,84.067,78.033,95.017,87.25,69.0833,75.633,73.917,91.583,84.95,73.817,83.367,77.317,78.25,75.733,74.45,93.9,75.8,79.95,82.033,75.8,70.917,84.083,73.017,82.233,79.833,77.4667,75.85,75.783,78.067,80.883,81.15,80.183,74.883,73.15,73.0,72.733,85.317,79.65,79.05,79.983,77.117,77.2,94.117,79.3,76.467,85.1,77.633,81.9,73.85,92.717,81.667,70.783,79.433,73.333,78.75,88.25,80.833,91.89,77.167,75.9,92.83,74.833,72.833,92.783,76.95,76.95,78.717,77.0,82.867,70.367,83.233],"marker":{"color":[-0.0062,0.0067,-0.0018,-0.0059,-0.0294,-0.0155,-0.007,0.0124,-0.0085,0.036,-0.0169,0.0107,-0.0036,-0.0221,-0.0161,0.0699,0.0172,0.0114,0.0347,-0.0103,-0.0162,0.0465,0.0156,0.0344,0.0208,-0.0046,0.0436,0.052,-0.0821,0.017,0.0089,-0.0076,0.0141,-0.0181,0.0224,0.0039,-0.0092,-0.0184,-0.0034,-0.0492,0.0633,0.003,-0.0252,-0.0001,0.0067,0.0026,-0.0185,0.0097,0.026,0.0213,0.0691,-0.0186,0.0334,0.0257,-0.0372,0.0123,0.0237,0.0233,0.0252,0.0141,-0.0062,0.0053,0.0155,-0.0246,0.0235,0.0056,-0.0024,0.0955,0.0248,-0.0116,-0.0219,0.0263,-0.0096,-0.0004,0.0307,0.0014,0.0157,-0.0089,0.0032,0.0015,-0.0524,-0.0226,0.0135,0.004,0.0038,0.0161,0.0488,0.0232,0.0394,0.0086,0.0206,0.0146,0.0229,-0.013,0.0248,-0.034],"coloraxis":"coloraxis"},"mode":"markers","name":"","showlegend":false,"subplot":"mapbox","type":"scattermapbox"}],                        {"coloraxis":{"cmax":0.1,"cmin":-0.1,"colorbar":{"title":{"text":"Estimated Yearly Increase(\u00b0C)"}},"colorscale":[[0.0,"rgb(26,26,26)"],[0.1,"rgb(77,77,77)"],[0.2,"rgb(135,135,135)"],[0.3,"rgb(186,186,186)"],[0.4,"rgb(224,224,224)"],[0.5,"rgb(255,255,255)"],[0.6,"rgb(253,219,199)"],[0.7,"rgb(244,165,130)"],[0.8,"rgb(214,96,77)"],[0.9,"rgb(178,24,43)"],[1.0,"rgb(103,0,31)"]]},"legend":{"tracegroupgap":0},"mapbox":{"center":{"lat":20.857903124999996,"lon":79.60784374999999},"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"style":"carto-positron","zoom":2},"margin":{"b":0,"l":0,"r":0,"t":30},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Estimates of yearly increase in temperature in January for stations in India, years 1980-2020"}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('69ca08da-1a4a-4fc9-87d0-7e85f79a646a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}} {%endif%}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>


# Q4: Two More Interesting Figures
Now let's do some application! We are going to repeat the process above (selecting data from our database, organizing the dataframe, adding data, filtering out data, and plotting) to answer some of our own questions!

**Your friend, who does not believe in climate change, claims that factors such as elevation and distance from the equator are why people believe that global warming is real. You want to gently correct them, but need the visual to get through to them.** 

We need to answer the question: Is there a relationship between temperature increase, latitude, or elevation?

**1)** We need to update our query to include elevation data


```python
#3d scatterplot for latitude, stn elev, and temperature change
def query_climate_scatter(country,year_begin,year_end,month):  
    country = country.replace("\"" ,'')
    com_str = ("SELECT S.name, S.latitude, S.longitude,S.stnelev,C.name, T.year, T.month, T.temp "
              + "FROM stations S " + "LEFT JOIN temperatures T on S.id = T.id " + "LEFT JOIN countries C on T.fips = C.fips "
              + "WHERE T.month = " + str(month) + " AND T.year >= " + str(year_begin) +
                " AND T.year <= " + str(year_end) + " AND C.name = '" + country + "'" )
    cmd =  com_str
    selected_data = pd.read_sql_query(cmd,conn)
    return selected_data

```


```python
scatter_pd = query_climate_scatter("India",1980,2020,1)
scatter_pd
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>STNELEV</th>
      <th>Name</th>
      <th>Year</th>
      <th>Month</th>
      <th>Temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>364.0</td>
      <td>India</td>
      <td>1980</td>
      <td>1</td>
      <td>23.48</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>364.0</td>
      <td>India</td>
      <td>1981</td>
      <td>1</td>
      <td>24.57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>364.0</td>
      <td>India</td>
      <td>1982</td>
      <td>1</td>
      <td>24.19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>364.0</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>23.51</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>364.0</td>
      <td>India</td>
      <td>1984</td>
      <td>1</td>
      <td>24.81</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3147</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>9999.0</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>5.10</td>
    </tr>
    <tr>
      <th>3148</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>9999.0</td>
      <td>India</td>
      <td>1986</td>
      <td>1</td>
      <td>6.90</td>
    </tr>
    <tr>
      <th>3149</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>9999.0</td>
      <td>India</td>
      <td>1994</td>
      <td>1</td>
      <td>8.10</td>
    </tr>
    <tr>
      <th>3150</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>9999.0</td>
      <td>India</td>
      <td>1995</td>
      <td>1</td>
      <td>5.60</td>
    </tr>
    <tr>
      <th>3151</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>9999.0</td>
      <td>India</td>
      <td>1997</td>
      <td>1</td>
      <td>5.70</td>
    </tr>
  </tbody>
</table>
<p>3152 rows × 8 columns</p>
</div>



**2)** Plot!


```python
def temp_lat_elev_scatter(country, year_begin, year_end, month,
                            **kwargs):
    month_digits = {1: "January",
                   2:"February",
                   3:"March",
                   4:"April",
                    5:"May",
                    6:"June",
                    7:"July",
                    8:"August",
                    9:"September",
                    10:"October",
                    11:"November",
                    12:"December"
                   }
    map_title = ("Relationship Between Latitude, Longtitude, and Estimated change in temperature in " 
             + month_digits[month] + " for stations in " + country + ", years " 
             + str(year_begin) +"-" + str(year_end)
            )
    country_pd = query_climate_scatter(country,year_begin,year_end,month)
    #print(country_pd)
    degree_sign = u"\N{DEGREE SIGN}"
    country_coefs = country_pd.groupby(["NAME", "Month","LATITUDE","LONGITUDE","STNELEV"]).apply(coef)
    country_coefs = country_coefs.reset_index()
    country_coefs["Estimated Yearly Increase(" + degree_sign +"C)"] = country_coefs[0].round(4)
    country_coefs = country_coefs.drop([0], axis = 1)
    #print(country_coefs)
    fig = px.scatter_3d(country_coefs, x = "LATITUDE", y = "STNELEV",z = "Estimated Yearly Increase(" + degree_sign +"C)",hover_name = "NAME",color ="LATITUDE",
                       title = map_title)
    
    ##calculate increase = T2-T1/amount of years --> average increase per year 
    ##group by name so that each station gets one point 
    return fig
```


```python
fig = temp_lat_elev_scatter("India", 1980,2020,1)
fig.update_layout(title = {'y': .9, 'x':0}, font_size = 12)
fig.show()
```


<div>                            <div id="04673c93-c287-4cb7-831a-63b9b034232a" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("04673c93-c287-4cb7-831a-63b9b034232a")) {                    Plotly.newPlot(                        "04673c93-c287-4cb7-831a-63b9b034232a",                        [{"hovertemplate":"<b>%{hovertext}</b><br><br>LATITUDE=%{marker.color}<br>STNELEV=%{y}<br>Estimated Yearly Increase(\u00b0C)=%{z}<extra></extra>","hovertext":["AGARTALA","AGRA","AHMADABAD","AKOLA","AKOLA","ALLAHABAD","ALLAHABAD_BAMHRAULI","AMBALA","AMRITSAR","AURANGABAD_CHIKALTH","BALASORE","BANGALORE","BANGALORE_HINDUSTAN","BAREILLY","BEGUMPETOBSY","BELGAUM_SAMBRA","BHOPAL_BAIRAGARH","BHUBANESWAR","BHUJ_RUDRAMATA","BIKANER","BOMBAY_COLABA","BOMBAY_SANTACRUZ","CALCUTTA_ALIPORE","CALCUTTA_DUM_DUM","CHERRAPUNJI","CHERRA_POONJEE","CHITRADURGA","COIMBATORE_PEELAMED","CUDDALORE","CUTTACK","DALTONGANJ","DARBHANGA","DARJEELING","DEHRADUN","DIBRUGARH_MOHANBAR","DUMKA","DWARKA","GADAG","GANGANAGAR","GAUHATI","GAYA","GOA_PANJIM","GORAKHPUR","GUNA","GWALIOR","HISSAR","HONAVAR","IMPHAL","INDORE","JABALPUR","JAGDALPUR","JAIPUR_SANGANER","JAISALMER","JHARSUGUDA","JODHPUR","KAKINADA","KARAIKAL","KODAIKANAL","KOTA_AERODROME","KOZHIKODE","KURNOOL","LUCKNOW_AMAUSI","LUDHIANA","MACHILIPATNAM","MADRAS_MINAMBAKKAM","MANGALORE","MANGALORE_BAJPE","MINICOY","MINICOYOBSY","MO_AMINI","MO_RANCHI","MUKTESWAR_KUMAON","NAGPUR_SONEGAON","NELLORE","NEW_DELHI_PALAM","NEW_DELHI_SAFDARJUN","NORTH_LAKHIMPUR","PAMBAN","PATIALA","PATNA","PBO_ANANTAPUR","PENDRA_ROAD","POONA","PORT_BLAIR","RAIPUR","RAJKOT","RAMGUNDAM","RATNAGIRI","SAGAR","SANDHEADS","SATNA","SHILONG","SHIMLA","SHOLAPUR","SILCHAR","SRINAGAR","SURAT","TEZPUR","THIRUVANANTHAPURAM","THIRUVANANTHAPURAM","TIRUCHCHIRAPALLI","TRIVANDRUM","UDAIPUR_DABOK","VARANASI_BABATPUR","VERAVAL","VISHAKHAPATNAM"],"legendgroup":"","marker":{"color":[23.883,27.1667,23.067,20.7,20.7,25.441,25.5,30.383,31.71,19.85,21.517,12.967,12.95,28.367,17.45,15.85,23.283,20.25,23.25,28.0,18.9,19.117,22.533,22.65,25.25,25.25,14.233,11.033,11.767,20.467,24.05,26.1667,27.05,30.317,27.483,24.267,22.3667,15.417,29.917,26.1,24.75,15.483,26.75,24.65,26.233,29.167,14.283,24.667,22.717,23.2,19.083,26.817,26.9,21.917,26.3,16.95,10.917,10.2333,25.15,11.25,15.8,26.75,30.9333,16.2,13.0,12.867,12.917,8.3,8.3,11.117,23.317,29.4667,21.1,14.45,28.567,28.583,27.233,9.267,30.333,25.6,14.583,22.767,18.533,11.667,21.217,22.3,18.767,16.983,23.85,20.85,24.567,25.6,31.1,17.667,24.82,34.083,21.2,26.617,8.467,8.483,10.767,8.5,24.617,25.45,20.9,17.717],"coloraxis":"coloraxis","symbol":"circle"},"mode":"markers","name":"","scene":"scene","showlegend":false,"type":"scatter3d","x":[23.883,27.1667,23.067,20.7,20.7,25.441,25.5,30.383,31.71,19.85,21.517,12.967,12.95,28.367,17.45,15.85,23.283,20.25,23.25,28.0,18.9,19.117,22.533,22.65,25.25,25.25,14.233,11.033,11.767,20.467,24.05,26.1667,27.05,30.317,27.483,24.267,22.3667,15.417,29.917,26.1,24.75,15.483,26.75,24.65,26.233,29.167,14.283,24.667,22.717,23.2,19.083,26.817,26.9,21.917,26.3,16.95,10.917,10.2333,25.15,11.25,15.8,26.75,30.9333,16.2,13.0,12.867,12.917,8.3,8.3,11.117,23.317,29.4667,21.1,14.45,28.567,28.583,27.233,9.267,30.333,25.6,14.583,22.767,18.533,11.667,21.217,22.3,18.767,16.983,23.85,20.85,24.567,25.6,31.1,17.667,24.82,34.083,21.2,26.617,8.467,8.483,10.767,8.5,24.617,25.45,20.9,17.717],"y":[16.0,168.0,55.0,282.0,305.0,98.1,98.0,272.0,230.4,579.0,20.0,921.0,897.0,169.0,527.0,747.0,523.0,46.0,80.0,224.0,11.0,14.0,6.0,6.0,1313.0,1313.0,733.0,399.0,12.0,27.0,221.0,47.0,9999.0,682.0,111.0,149.0,10.0,650.0,177.0,54.0,116.0,60.0,77.0,478.0,207.0,221.0,9.0,774.0,567.0,393.0,553.0,390.0,231.0,230.0,224.0,8.0,7.0,2339.0,274.0,5.0,281.0,128.0,255.0,3.0,16.0,22.0,102.0,2.0,2.0,3.0,652.0,2311.0,310.0,20.0,233.0,216.0,102.0,11.0,251.0,60.0,364.0,625.0,559.0,79.0,294.0,138.0,156.0,67.0,551.0,10.0,317.0,9999.0,2202.0,479.0,32.0,1587.0,12.0,79.0,8.0,64.0,88.0,64.0,514.0,85.0,8.0,3.0],"z":[-0.0062,-0.0954,0.0067,-0.0018,-0.0059,-0.0294,-0.0155,0.0814,-0.007,0.0124,-0.0085,0.036,0.05,-0.0169,0.0107,-0.0036,-0.0221,-0.0161,0.0699,0.0172,0.0114,0.0347,-0.0103,-0.0162,0.0465,-0.022,0.0156,0.0344,0.0208,-0.0101,-0.0046,-0.0716,-0.0401,0.0436,0.052,-0.0821,0.017,0.0089,-0.0076,0.0141,-0.0181,0.0224,0.0039,-0.0092,-0.0184,-0.0034,-0.0492,0.0633,0.003,-0.0252,-0.0001,0.0067,0.0026,-0.0185,0.0097,0.026,0.0213,0.0691,-0.0186,0.0334,0.0257,-0.0372,0.1318,0.0123,0.0237,0.0,0.0233,0.0252,0.0141,-0.0062,0.0053,0.0155,-0.0246,0.0235,0.0056,-0.0024,0.0955,0.0248,-0.0116,-0.0219,0.0263,-0.0096,-0.0004,0.0307,0.0014,0.0157,-0.0089,0.0032,0.0015,-0.0524,-0.0226,0.0135,0.004,0.0038,0.0161,0.0488,0.0232,0.0394,0.0086,0.0206,0.0146,0.0229,0.0724,-0.013,0.0248,-0.034]}],                        {"coloraxis":{"colorbar":{"title":{"text":"LATITUDE"}},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"font":{"size":12},"legend":{"tracegroupgap":0},"scene":{"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"xaxis":{"title":{"text":"LATITUDE"}},"yaxis":{"title":{"text":"STNELEV"}},"zaxis":{"title":{"text":"Estimated Yearly Increase(\u00b0C)"}}},"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Relationship Between Latitude, Longtitude, and change in temperature in January for stations in India, years 1980-2020","x":0,"y":0.9}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('04673c93-c287-4cb7-831a-63b9b034232a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>


As we can see, there is absolutely NO discernible correlation between estimated yearly increase, elevation, and latitude. 


```python
#histogram that shows how many stations in a country have reported increase in temperature over time period
#how many stations in blank recorded an increase in temperature
```


```python
#countries overall temperature increase 
cmd = \
"""
SELECT S.name, S.latitude, S.longitude, C.name, T.year, T.month, T.temp
FROM stations S
LEFT JOIN temperatures T on S.id = T.id
LEFT JOIN countries C on T.fips = C.fips
WHERE T.month = 1 AND T.year >= 1980 AND T.year <= 1990 AND C.name == 'India' OR'United States'OR 'Zimbabwe'
"""
test = pd.read_sql_query(cmd,conn)
test
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>Name</th>
      <th>Year</th>
      <th>Month</th>
      <th>Temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1980</td>
      <td>1</td>
      <td>23.48</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1981</td>
      <td>1</td>
      <td>24.57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1982</td>
      <td>1</td>
      <td>24.19</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>23.51</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PBO_ANANTAPUR</td>
      <td>14.583</td>
      <td>77.633</td>
      <td>India</td>
      <td>1984</td>
      <td>1</td>
      <td>24.81</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>820</th>
      <td>SHILONG</td>
      <td>25.600</td>
      <td>91.890</td>
      <td>India</td>
      <td>1990</td>
      <td>1</td>
      <td>11.20</td>
    </tr>
    <tr>
      <th>821</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1981</td>
      <td>1</td>
      <td>6.50</td>
    </tr>
    <tr>
      <th>822</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1982</td>
      <td>1</td>
      <td>8.70</td>
    </tr>
    <tr>
      <th>823</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1983</td>
      <td>1</td>
      <td>5.10</td>
    </tr>
    <tr>
      <th>824</th>
      <td>DARJEELING</td>
      <td>27.050</td>
      <td>88.270</td>
      <td>India</td>
      <td>1986</td>
      <td>1</td>
      <td>6.90</td>
    </tr>
  </tbody>
</table>
<p>825 rows × 7 columns</p>
</div>




```python
test_count = test.groupby("Name")
test_count.groups.keys()
```




    dict_keys(['Afghanistan', 'Albania', 'Algeria', 'American Samoa', 'Angola', 'Antarctica', 'Antigua and Barbuda', 'Argentina', 'Armenia', 'Australia', 'Austria', 'Azerbaijan', 'Bahamas, The', 'Bahrain', 'Bangladesh', 'Barbados', 'Belarus', 'Belgium', 'Belize', 'Benin', 'Bermuda', 'Bolivia', 'Bosnia and Herzegovina', 'Botswana', 'Brazil', 'British Indian Ocean Territory', 'Brunei', 'Bulgaria', 'Burkina Faso', 'Burma', 'Burundi', 'Cambodia', 'Cameroon', 'Canada', 'Cape Verde', 'Cayman Islands', 'Central African Republic', 'Chad', 'Chile', 'China', 'Christmas Island', 'Cocos (Keeling) Islands', 'Colombia', 'Comoros', 'Congo, Democratic Republic of the', 'Congo, Republic of the', 'Cook Islands', 'Costa Rica', "Cote d'Ivoire", 'Croatia', 'Cuba', 'Cyprus', 'Czech Republic', 'Denmark', 'Djibouti', 'Dominica', 'Dominican Republic', 'Ecuador', 'Egypt', 'El Salvador', 'Equatorial Guinea', 'Eritrea', 'Estonia', 'Ethiopia', 'Europa Island', 'Falkland Islands (Islas Malvinas)', 'Faroe Islands', 'Fiji', 'Finland', 'France', 'French Guiana', 'French Polynesia', 'French Southern and Antarctic Lands', 'Gabon', 'Gambia, The', 'Georgia', 'Germany', 'Ghana', 'Gibraltar', 'Greece', 'Greenland', 'Guadeloupe', 'Guam', 'Guatemala', 'Guernsey', 'Guinea', 'Guinea-Bissau', 'Guyana', 'Haiti', 'Honduras', 'Hong Kong', 'Hungary', 'Iceland', 'India', 'Indonesia', 'Iran', 'Iraq', 'Ireland', 'Isle of Man', 'Israel', 'Italy', 'Jamaica', 'Jan Mayen', 'Japan', 'Jersey', 'Johnston Atoll', 'Jordan', 'Juan de Nova Island', 'Kazakhstan', 'Kenya', 'Kiribati', 'Korea, North', 'Korea, South', 'Kuwait', 'Kyrgyzstan', 'Laos', 'Latvia', 'Lebanon', 'Lesotho', 'Liberia', 'Libya', 'Liechtenstein', 'Lithuania', 'Luxembourg', 'Macau', 'Macedonia', 'Madagascar', 'Malawi', 'Malaysia', 'Maldives', 'Mali', 'Malta', 'Marshall Islands', 'Martinique', 'Mauritania', 'Mauritius', 'Mayotte', 'Mexico', 'Micronesia, Federated States of', 'Moldova', 'Mongolia', 'Montenegro', 'Morocco', 'Mozambique', 'Myanmar', 'Namibia', 'Nepal', 'Netherlands', 'New Caledonia', 'New Zealand', 'Nicaragua', 'Niger', 'Nigeria', 'Niue', 'Norfolk Island', 'Northern Mariana Islands', 'Norway', 'Oman', 'Pakistan', 'Palau', 'Panama', 'Papua New Guinea', 'Paraguay', 'Peru', 'Philippines', 'Pitcairn Islands', 'Poland', 'Portugal', 'Puerto Rico', 'Qatar', 'Reunion', 'Romania', 'Russia', 'Rwanda', 'Saint Helena', 'Saint Kitts and Nevis', 'Saint Pierre and Miquelon', 'Samoa', 'Sao Tome and Principe', 'Saudi Arabia', 'Senegal', 'Serbia', 'Seychelles', 'Sierra Leone', 'Singapore', 'Slovakia', 'Slovenia', 'Solomon Islands', 'South Africa', 'South Georgia and the Islands', 'Spain', 'Sri Lanka', 'Sudan', 'Suriname', 'Svalbard', 'Swaziland', 'Sweden', 'Switzerland', 'Syria', 'Taiwan', 'Tajikistan', 'Tanzania', 'Thailand', 'Timor-Leste', 'Togo', 'Tokelau', 'Tonga', 'Trinidad and Tobago', 'Tromelin Island', 'Tunisia', 'Turkey', 'Turkmenistan', 'Tuvalu', 'Uganda', 'Ukraine', 'United Arab Emirates', 'United Kingdom', 'United States', 'Uruguay', 'Uzbekistan', 'Vanuatu', 'Venezuela', 'Vietnam', 'Virgin Islands, U.S.', 'Wake Island', 'Wallis and Futuna', 'Western Sahara', 'Zambia', 'Zimbabwe'])




```python
##3-country historgram 
def three_country_histogram(country_1,country_2,country_3):
    """
    this function compares expected temperature increase for three countries 
    """
    #this is not ready yet
    return null
```

**Don't forget to CLOSE your database when you are done using it!**


```python
conn.close()
```
